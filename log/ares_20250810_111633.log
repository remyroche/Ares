{"asctime": "2025-08-10 11:16:33,029", "levelname": "INFO", "name": "AresTradingSystem", "message": "‚úÖ Enhanced Logger initialization completed successfully", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.029583+00:00"}
{"asctime": "2025-08-10 11:16:33,038", "levelname": "INFO", "name": "AresTradingSystem.System", "message": "Environment configuration loaded successfully. Trading Environment: PAPER, Exchange: BINANCE", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.038107+00:00"}
{"asctime": "2025-08-10 11:16:33,476", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üöÄ Initializing Unified Data Converter...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.476397+00:00"}
{"asctime": "2025-08-10 11:16:33,476", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Unified data directory: data_cache/unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.476561+00:00"}
{"asctime": "2025-08-10 11:16:33,476", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Backup directory: data_cache/backup_pre_unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.476642+00:00"}
{"asctime": "2025-08-10 11:16:33,476", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.476884+00:00"}
{"asctime": "2025-08-10 11:16:33,476", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ STEP 1.5: Unified Data Converter", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.476949+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477012+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üéØ Symbol: BTCUSDT", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477068+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üè¢ Exchange: binance", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477126+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Timeframe: 1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477182+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Data directory: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477237+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üì¶ Backing up existing consolidated data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477306+00:00"}
{"asctime": "2025-08-10 11:16:33,477", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.477948+00:00"}
{"asctime": "2025-08-10 11:16:33,478", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.478800+00:00"}
{"asctime": "2025-08-10 11:16:33,479", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.479266+00:00"}
{"asctime": "2025-08-10 11:16:33,479", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Backup completed: 3 files backed up", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.479334+00:00"}
{"asctime": "2025-08-10 11:16:33,479", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ Converting existing consolidated data to unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.479397+00:00"}
{"asctime": "2025-08-10 11:16:33,479", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading klines from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.479501+00:00"}
{"asctime": "2025-08-10 11:16:33,505", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 1440 klines rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.505213+00:00"}
{"asctime": "2025-08-10 11:16:33,505", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading aggtrades from consolidated parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.505427+00:00"}
{"asctime": "2025-08-10 11:16:33,508", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 86400 aggtrades rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.508155+00:00"}
{"asctime": "2025-08-10 11:16:33,508", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading futures from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.508383+00:00"}
{"asctime": "2025-08-10 11:16:33,509", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 3 futures rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.509393+00:00"}
{"asctime": "2025-08-10 11:16:33,509", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging data into unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.509495+00:00"}
{"asctime": "2025-08-10 11:16:33,512", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Data availability summary:", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.512523+00:00"}
{"asctime": "2025-08-10 11:16:33,512", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Klines: 1440 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.512694+00:00"}
{"asctime": "2025-08-10 11:16:33,512", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades: 86400 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.512771+00:00"}
{"asctime": "2025-08-10 11:16:33,512", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures: 3 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.512840+00:00"}
{"asctime": "2025-08-10 11:16:33,512", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging aggtrades data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.512898+00:00"}
{"asctime": "2025-08-10 11:16:33,532", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades data merged: 1440 kline periods aggregated", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.532494+00:00"}
{"asctime": "2025-08-10 11:16:33,533", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging futures data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.533068+00:00"}
{"asctime": "2025-08-10 11:16:33,534", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üìä Futures data coverage: 2024-01-01 00:00:00+00:00 to 2024-01-01 16:00:00+00:00 (3 records)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.534177+00:00"}
{"asctime": "2025-08-10 11:16:33,536", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures data merged: 100.0% of klines have funding rates", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.536103+00:00"}
{"asctime": "2025-08-10 11:16:33,536", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß Filling missing values...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.536287+00:00"}
{"asctime": "2025-08-10 11:16:33,537", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ No missing values found", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.537379+00:00"}
{"asctime": "2025-08-10 11:16:33,537", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Unified dataset created: 1440 rows, 19 columns", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.537755+00:00"}
{"asctime": "2025-08-10 11:16:33,537", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìã Columns: ['timestamp', 'open', 'high', 'low', 'close', 'volume', 'exchange', 'symbol', 'timeframe', 'year', 'month', 'day', 'trade_volume', 'trade_count', 'avg_price', 'min_price', 'max_price', 'volume_ratio', 'funding_rate']", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.537840+00:00"}
{"asctime": "2025-08-10 11:16:33,537", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üíæ Writing unified dataset with partitioning...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:33.537960+00:00"}
{"asctime": "2025-08-10 11:16:34,936", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Preparing to write dataset: rows=1440, cols=19, cols[0..11]=[timestamp,open,high,low,close,volume,exchange,symbol,timeframe,year,month,day] -> /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/unified/binance/BTCUSDT/1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.936004+00:00"}
{"asctime": "2025-08-10 11:16:34,936", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Timestamp coverage: 2024-01-01 00:00:00+00:00 ‚Üí 2024-01-01 23:59:00+00:00 (UTC)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.936690+00:00"}
{"asctime": "2025-08-10 11:16:34,937", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Writing partitioned dataset to /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/unified/binance/BTCUSDT/1m with compression=snappy", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.937904+00:00"}
{"asctime": "2025-08-10 11:16:34,938", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß write_partitioned_dataset start path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/unified/binance/BTCUSDT/1m compression=snappy min_rows_per_group=50000 max_rows_per_file=1000000", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.938071+00:00"}
{"asctime": "2025-08-10 11:16:34,938", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå write_partitioned_dataset failed path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmpg863id6u/data_cache/unified/binance/BTCUSDT/1m after 0.000s: max_rows_per_group must be less than or equal to max_rows_per_file", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/utils/logger.py\", line 651, in log_io_operation\n    yield\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: max_rows_per_group must be less than or equal to max_rows_per_file", "timestamp": "2025-08-10T09:16:34.938484+00:00"}
{"asctime": "2025-08-10 11:16:34,940", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset: max_rows_per_group must be less than or equal to max_rows_per_file", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/training/steps/step1_5_data_converter.py\", line 638, in _write_unified_dataset\n    pdm.write_partitioned_dataset(\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: max_rows_per_group must be less than or equal to max_rows_per_file", "timestamp": "2025-08-10T09:16:34.940663+00:00"}
{"asctime": "2025-08-10 11:16:34,941", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.941830+00:00"}
{"asctime": "2025-08-10 11:16:34,942", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to convert existing data", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:16:34.942213+00:00"}
