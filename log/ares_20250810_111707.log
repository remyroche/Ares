{"asctime": "2025-08-10 11:17:07,604", "levelname": "INFO", "name": "AresTradingSystem", "message": "‚úÖ Enhanced Logger initialization completed successfully", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:07.604284+00:00"}
{"asctime": "2025-08-10 11:17:07,611", "levelname": "INFO", "name": "AresTradingSystem.System", "message": "Environment configuration loaded successfully. Trading Environment: PAPER, Exchange: BINANCE", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:07.611818+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üöÄ Initializing Unified Data Converter...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023201+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Unified data directory: data_cache/unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023359+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Backup directory: data_cache/backup_pre_unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023429+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023663+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ STEP 1.5: Unified Data Converter", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023723+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023782+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üéØ Symbol: BTCUSDT", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023835+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üè¢ Exchange: binance", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023892+00:00"}
{"asctime": "2025-08-10 11:17:08,023", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Timeframe: 1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.023947+00:00"}
{"asctime": "2025-08-10 11:17:08,024", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Data directory: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.024003+00:00"}
{"asctime": "2025-08-10 11:17:08,024", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üì¶ Backing up existing consolidated data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.024073+00:00"}
{"asctime": "2025-08-10 11:17:08,024", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.024609+00:00"}
{"asctime": "2025-08-10 11:17:08,025", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.025410+00:00"}
{"asctime": "2025-08-10 11:17:08,025", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.025850+00:00"}
{"asctime": "2025-08-10 11:17:08,025", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Backup completed: 3 files backed up", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.025914+00:00"}
{"asctime": "2025-08-10 11:17:08,025", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ Converting existing consolidated data to unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.025978+00:00"}
{"asctime": "2025-08-10 11:17:08,026", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading klines from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.026079+00:00"}
{"asctime": "2025-08-10 11:17:08,048", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 1440 klines rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.048322+00:00"}
{"asctime": "2025-08-10 11:17:08,048", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading aggtrades from consolidated parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.048538+00:00"}
{"asctime": "2025-08-10 11:17:08,051", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 86400 aggtrades rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.051414+00:00"}
{"asctime": "2025-08-10 11:17:08,051", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading futures from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.051644+00:00"}
{"asctime": "2025-08-10 11:17:08,052", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 3 futures rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.052924+00:00"}
{"asctime": "2025-08-10 11:17:08,053", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging data into unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.053094+00:00"}
{"asctime": "2025-08-10 11:17:08,055", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Data availability summary:", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.055725+00:00"}
{"asctime": "2025-08-10 11:17:08,055", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Klines: 1440 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.055846+00:00"}
{"asctime": "2025-08-10 11:17:08,055", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades: 86400 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.055925+00:00"}
{"asctime": "2025-08-10 11:17:08,055", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures: 3 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.055992+00:00"}
{"asctime": "2025-08-10 11:17:08,056", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging aggtrades data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.056053+00:00"}
{"asctime": "2025-08-10 11:17:08,071", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades data merged: 1440 kline periods aggregated", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.071455+00:00"}
{"asctime": "2025-08-10 11:17:08,071", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging futures data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.071676+00:00"}
{"asctime": "2025-08-10 11:17:08,072", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üìä Futures data coverage: 2024-01-01 00:00:00+00:00 to 2024-01-01 16:00:00+00:00 (3 records)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.072311+00:00"}
{"asctime": "2025-08-10 11:17:08,073", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures data merged: 100.0% of klines have funding rates", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.073162+00:00"}
{"asctime": "2025-08-10 11:17:08,073", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß Filling missing values...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.073246+00:00"}
{"asctime": "2025-08-10 11:17:08,074", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ No missing values found", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.074125+00:00"}
{"asctime": "2025-08-10 11:17:08,074", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Unified dataset created: 1440 rows, 19 columns", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.074431+00:00"}
{"asctime": "2025-08-10 11:17:08,074", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìã Columns: ['timestamp', 'open', 'high', 'low', 'close', 'volume', 'exchange', 'symbol', 'timeframe', 'year', 'month', 'day', 'trade_volume', 'trade_count', 'avg_price', 'min_price', 'max_price', 'volume_ratio', 'funding_rate']", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.074504+00:00"}
{"asctime": "2025-08-10 11:17:08,074", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üíæ Writing unified dataset with partitioning...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.074569+00:00"}
{"asctime": "2025-08-10 11:17:08,636", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Preparing to write dataset: rows=1440, cols=19, cols[0..11]=[timestamp,open,high,low,close,volume,exchange,symbol,timeframe,year,month,day] -> /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/unified/binance/BTCUSDT/1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.636059+00:00"}
{"asctime": "2025-08-10 11:17:08,636", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Timestamp coverage: 2024-01-01 00:00:00+00:00 ‚Üí 2024-01-01 23:59:00+00:00 (UTC)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.636723+00:00"}
{"asctime": "2025-08-10 11:17:08,637", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Writing partitioned dataset to /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/unified/binance/BTCUSDT/1m with compression=snappy", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.637849+00:00"}
{"asctime": "2025-08-10 11:17:08,637", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß write_partitioned_dataset start path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/unified/binance/BTCUSDT/1m compression=snappy min_rows_per_group=50000 max_rows_per_file=1000000", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.637962+00:00"}
{"asctime": "2025-08-10 11:17:08,638", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå write_partitioned_dataset failed path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmprpioc3j_/data_cache/unified/binance/BTCUSDT/1m after 0.000s: max_rows_per_group must be less than or equal to max_rows_per_file", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/utils/logger.py\", line 651, in log_io_operation\n    yield\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: max_rows_per_group must be less than or equal to max_rows_per_file", "timestamp": "2025-08-10T09:17:08.638391+00:00"}
{"asctime": "2025-08-10 11:17:08,639", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset: max_rows_per_group must be less than or equal to max_rows_per_file", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/training/steps/step1_5_data_converter.py\", line 638, in _write_unified_dataset\n    pdm.write_partitioned_dataset(\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: max_rows_per_group must be less than or equal to max_rows_per_file", "timestamp": "2025-08-10T09:17:08.639831+00:00"}
{"asctime": "2025-08-10 11:17:08,640", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.640598+00:00"}
{"asctime": "2025-08-10 11:17:08,640", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to convert existing data", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:08.640730+00:00"}
