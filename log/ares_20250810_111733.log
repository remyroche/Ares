{"asctime": "2025-08-10 11:17:33,448", "levelname": "INFO", "name": "AresTradingSystem", "message": "‚úÖ Enhanced Logger initialization completed successfully", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.448314+00:00"}
{"asctime": "2025-08-10 11:17:33,456", "levelname": "INFO", "name": "AresTradingSystem.System", "message": "Environment configuration loaded successfully. Trading Environment: PAPER, Exchange: BINANCE", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.456455+00:00"}
{"asctime": "2025-08-10 11:17:33,852", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üöÄ Initializing Unified Data Converter...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.852923+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Unified data directory: data_cache/unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853129+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Backup directory: data_cache/backup_pre_unified", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853197+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853429+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ STEP 1.5: Unified Data Converter", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853492+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "================================================================================", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853550+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üéØ Symbol: BTCUSDT", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853603+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üè¢ Exchange: binance", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853663+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Timeframe: 1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853718+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìÅ Data directory: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853773+00:00"}
{"asctime": "2025-08-10 11:17:33,853", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üì¶ Backing up existing consolidated data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.853840+00:00"}
{"asctime": "2025-08-10 11:17:33,854", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.854381+00:00"}
{"asctime": "2025-08-10 11:17:33,855", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.855231+00:00"}
{"asctime": "2025-08-10 11:17:33,855", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üì¶ Backed up: futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.855689+00:00"}
{"asctime": "2025-08-10 11:17:33,855", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Backup completed: 3 files backed up", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.855759+00:00"}
{"asctime": "2025-08-10 11:17:33,855", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîÑ Converting existing consolidated data to unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.855822+00:00"}
{"asctime": "2025-08-10 11:17:33,855", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading klines from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/klines_binance_BTCUSDT_1m_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.855918+00:00"}
{"asctime": "2025-08-10 11:17:33,881", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 1440 klines rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.881248+00:00"}
{"asctime": "2025-08-10 11:17:33,881", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading aggtrades from consolidated parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/aggtrades_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.881497+00:00"}
{"asctime": "2025-08-10 11:17:33,885", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 86400 aggtrades rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.885462+00:00"}
{"asctime": "2025-08-10 11:17:33,885", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Loading futures from parquet: /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/futures_binance_BTCUSDT_consolidated.parquet", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.885743+00:00"}
{"asctime": "2025-08-10 11:17:33,887", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Loaded 3 futures rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.887281+00:00"}
{"asctime": "2025-08-10 11:17:33,887", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging data into unified format...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.887455+00:00"}
{"asctime": "2025-08-10 11:17:33,890", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìä Data availability summary:", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.890124+00:00"}
{"asctime": "2025-08-10 11:17:33,890", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Klines: 1440 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.890294+00:00"}
{"asctime": "2025-08-10 11:17:33,890", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades: 86400 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.890370+00:00"}
{"asctime": "2025-08-10 11:17:33,890", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures: 3 rows", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.890434+00:00"}
{"asctime": "2025-08-10 11:17:33,890", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging aggtrades data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.890493+00:00"}
{"asctime": "2025-08-10 11:17:33,908", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Aggtrades data merged: 1440 kline periods aggregated", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.908419+00:00"}
{"asctime": "2025-08-10 11:17:33,908", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîó Merging futures data...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.908804+00:00"}
{"asctime": "2025-08-10 11:17:33,909", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   üìä Futures data coverage: 2024-01-01 00:00:00+00:00 to 2024-01-01 16:00:00+00:00 (3 records)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.909562+00:00"}
{"asctime": "2025-08-10 11:17:33,910", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ Futures data merged: 100.0% of klines have funding rates", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.910574+00:00"}
{"asctime": "2025-08-10 11:17:33,910", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß Filling missing values...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.910673+00:00"}
{"asctime": "2025-08-10 11:17:33,911", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "   ‚úÖ No missing values found", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.911631+00:00"}
{"asctime": "2025-08-10 11:17:33,911", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚úÖ Unified dataset created: 1440 rows, 19 columns", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.911934+00:00"}
{"asctime": "2025-08-10 11:17:33,912", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üìã Columns: ['timestamp', 'open', 'high', 'low', 'close', 'volume', 'exchange', 'symbol', 'timeframe', 'year', 'month', 'day', 'trade_volume', 'trade_count', 'avg_price', 'min_price', 'max_price', 'volume_ratio', 'funding_rate']", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.912007+00:00"}
{"asctime": "2025-08-10 11:17:33,912", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üíæ Writing unified dataset with partitioning...", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:33.912075+00:00"}
{"asctime": "2025-08-10 11:17:35,012", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Preparing to write dataset: rows=1440, cols=19, cols[0..11]=[timestamp,open,high,low,close,volume,exchange,symbol,timeframe,year,month,day] -> /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/unified/binance/BTCUSDT/1m", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.012021+00:00"}
{"asctime": "2025-08-10 11:17:35,012", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Timestamp coverage: 2024-01-01 00:00:00+00:00 ‚Üí 2024-01-01 23:59:00+00:00 (UTC)", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.012612+00:00"}
{"asctime": "2025-08-10 11:17:35,013", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "Writing partitioned dataset to /var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/unified/binance/BTCUSDT/1m with compression=snappy", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.013759+00:00"}
{"asctime": "2025-08-10 11:17:35,013", "levelname": "INFO", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "üîß write_partitioned_dataset start path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/unified/binance/BTCUSDT/1m compression=snappy min_rows_per_group=50000 max_rows_per_file=5000000", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.013857+00:00"}
{"asctime": "2025-08-10 11:17:35,032", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå write_partitioned_dataset failed path=/var/folders/dr/hz7y0z9j0x39z7519pbshgqh0000gn/T/tmphchd89_5/data_cache/unified/binance/BTCUSDT/1m after 0.018s: Fragment would be written into 1440 partitions. This exceeds the maximum of 1024", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/utils/logger.py\", line 651, in log_io_operation\n    yield\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: Fragment would be written into 1440 partitions. This exceeds the maximum of 1024", "timestamp": "2025-08-10T09:17:35.032270+00:00"}
{"asctime": "2025-08-10 11:17:35,034", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset: Fragment would be written into 1440 partitions. This exceeds the maximum of 1024", "correlation_id": "-", "session_id": "-", "exc_info": "Traceback (most recent call last):\n  File \"/Users/remyroche/Documents/Ares/src/training/steps/step1_5_data_converter.py\", line 638, in _write_unified_dataset\n    pdm.write_partitioned_dataset(\n  File \"/Users/remyroche/Documents/Ares/src/training/enhanced_training_manager_optimized.py\", line 304, in write_partitioned_dataset\n    ds.write_dataset(table, **write_args)\n  File \"/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/pyarrow/dataset.py\", line 1034, in write_dataset\n    _filesystemdataset_write(\n  File \"pyarrow/_dataset.pyx\", line 4147, in pyarrow._dataset._filesystemdataset_write\n  File \"pyarrow/error.pxi\", line 92, in pyarrow.lib.check_status\npyarrow.lib.ArrowInvalid: Fragment would be written into 1440 partitions. This exceeds the maximum of 1024", "timestamp": "2025-08-10T09:17:35.034995+00:00"}
{"asctime": "2025-08-10 11:17:35,036", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to write unified dataset", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.036890+00:00"}
{"asctime": "2025-08-10 11:17:35,037", "levelname": "ERROR", "name": "AresTradingSystem.System.UnifiedDataConverter", "message": "‚ùå Failed to convert existing data", "correlation_id": "-", "session_id": "-", "timestamp": "2025-08-10T09:17:35.037067+00:00"}
