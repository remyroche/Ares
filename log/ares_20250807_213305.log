2025-08-07 21:33:05,686 - AresTradingSystem - INFO - ‚úÖ Enhanced Logger initialization completed successfully
2025-08-07 21:33:05,693 - AresTradingSystem.System - INFO - Environment configuration loaded successfully. Trading Environment: PAPER, Exchange: BINANCE
2025-08-07 21:33:05,940 - AresTradingSystem.System.SignalHandler - INFO - Initializing Signal Handler...
2025-08-07 21:33:05,940 - AresTradingSystem.System.SignalHandler - INFO - Signal configuration loaded successfully
2025-08-07 21:33:05,940 - AresTradingSystem.System.SignalHandler - INFO - Configuration validation successful
2025-08-07 21:33:05,940 - AresTradingSystem.System.SignalHandler - INFO - Registered SIGTERM handler
2025-08-07 21:33:05,940 - AresTradingSystem.System.SignalHandler - INFO - Registered SIGINT handler
2025-08-07 21:33:05,941 - AresTradingSystem.System.SignalHandler - INFO - Signal handlers registered successfully
2025-08-07 21:33:05,941 - AresTradingSystem.System.SignalHandler - INFO - ‚úÖ Signal Handler initialization completed successfully
2025-08-07 21:33:05,942 - AresTradingSystem.System.SignalHandler - INFO - Shutdown callback registered
2025-08-07 21:33:07,295 - AresTradingSystem.System - INFO - Initializing Market Regime Classification Step...
2025-08-07 21:33:07,295 - AresTradingSystem.System - INFO - Market Regime Classification Step initialized successfully
2025-08-07 21:33:07,295 - AresTradingSystem.System - INFO - üîÑ Executing Market Regime Classification...
2025-08-07 21:33:07,295 - AresTradingSystem.System - INFO - üìÅ Loading pre-consolidated data from: data_cache/aggtrades_BINANCE_ETHUSDT_consolidated.parquet
2025-08-07 21:33:07,531 - AresTradingSystem.System - INFO - ‚úÖ Loaded consolidated trade data: 17744326 records
2025-08-07 21:33:07,531 - AresTradingSystem.System - INFO - üîÑ Converting trade data to OHLCV format...
2025-08-07 21:33:08,625 - AresTradingSystem.System - INFO - ‚úÖ Converted to OHLCV: 879 records
2025-08-07 21:33:08,626 - AresTradingSystem.System - INFO - Classifying market regimes for ETHUSDT on BINANCE...
2025-08-07 21:33:08,626 - AresTradingSystem.System - INFO - Regime classification completed. Found 0 distinct regimes
2025-08-07 21:33:08,627 - AresTradingSystem.System - INFO - ‚úÖ Market regime classification completed. Results saved to data/training/BINANCE_ETHUSDT_regime_classification.json
2025-08-07 21:33:08,638 - AresTradingSystem.System - INFO - Initializing Regime Data Splitting Step...
2025-08-07 21:33:08,638 - AresTradingSystem.System - INFO - Regime Data Splitting Step initialized successfully
2025-08-07 21:33:08,638 - AresTradingSystem.System - INFO - üîÑ Executing Regime Data Splitting...
2025-08-07 21:33:08,642 - AresTradingSystem.System - INFO - ‚úÖ Extracted klines data: (60367, 5)
2025-08-07 21:33:08,642 - AresTradingSystem.System - INFO - Splitting data by regimes for ETHUSDT on BINANCE...
2025-08-07 21:33:08,642 - AresTradingSystem.System - INFO - Data shape: (60367, 5)
2025-08-07 21:33:08,642 - AresTradingSystem.System - WARNING - No regime sequence found, creating default sequence
2025-08-07 21:33:08,805 - AresTradingSystem.System - INFO - Regime 'BULL': 60367 records
2025-08-07 21:33:08,805 - AresTradingSystem.System - INFO - High-data regimes: ['BULL']
2025-08-07 21:33:08,805 - AresTradingSystem.System - INFO - Low-data regimes: []
2025-08-07 21:33:08,805 - AresTradingSystem.System - INFO - Other regimes: []
2025-08-07 21:33:08,807 - AresTradingSystem.System - INFO - ‚úÖ Regime data splitting completed. Results saved to data/training/regime_data
2025-08-07 21:33:25,768 - AresTradingSystem.System - INFO - Initializing Analyst Specialist Training Step...
2025-08-07 21:33:25,768 - AresTradingSystem.System - INFO - Analyst Specialist Training Step initialized successfully
2025-08-07 21:33:25,768 - AresTradingSystem.System - INFO - üîÑ Executing Analyst Specialist Training...
2025-08-07 21:33:25,770 - AresTradingSystem.System - INFO - Training specialist models for regime: BULL
2025-08-07 21:33:25,770 - AresTradingSystem.System - INFO - Training specialist models for regime: BULL
2025-08-07 21:39:40,030 - AresTradingSystem.System - INFO - Trained 5 models for regime BULL
2025-08-07 21:39:40,041 - AresTradingSystem.System - INFO - ‚úÖ Analyst specialist training completed. Results saved to data/training/analyst_models
2025-08-07 21:39:42,978 - AresTradingSystem.System - INFO - Using device: MPS for PyTorch operations.
2025-08-07 21:39:42,978 - AresTradingSystem.System - INFO - Initializing Analyst Enhancement Step...
2025-08-07 21:39:42,978 - AresTradingSystem.System - INFO - Analyst Enhancement Step initialized successfully.
2025-08-07 21:39:42,978 - AresTradingSystem.System - INFO - üîÑ Executing Analyst Enhancement...
2025-08-07 21:39:42,985 - AresTradingSystem.System - INFO - --- Enhancing models for regime: BULL ---
2025-08-07 21:39:42,985 - AresTradingSystem.System - INFO - Loading data for regime 'BULL'...
2025-08-07 21:39:42,998 - AresTradingSystem.System - WARNING - No 'label' column found, creating dummy target
2025-08-07 21:39:43,001 - AresTradingSystem.System - INFO - Data loaded and split: X_train shape (48293, 3), X_val shape (12074, 3)
2025-08-07 21:39:43,002 - AresTradingSystem.System - INFO - Enhancing xgboost for BULL...
2025-08-07 21:39:43,002 - AresTradingSystem.System - INFO - Original model accuracy: 0.8399370026525199
2025-08-07 21:39:43,002 - AresTradingSystem.System - INFO - Running Optuna HPO with pruning for xgboost...
2025-08-07 21:39:43,022 - AresTradingSystem.System - ERROR - ‚ùå Error in Analyst Enhancement after 0.04s: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:regime: object
Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 407, in pandas_feature_info
    new_feature_types.append(_pandas_dtype_mapper[dtype.name])
                             ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
KeyError: 'object'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 104, in execute
    enhanced_model_package = await self._enhance_single_model(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 199, in _enhance_single_model
    best_params, hpo_score = await self._apply_hyperparameter_optimization(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 323, in _apply_hyperparameter_optimization
    await asyncio.to_thread(study.optimize, objective, n_trials=100, n_jobs=-1)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/study.py", line 489, in optimize
    _optimize(
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 101, in _optimize
    f.result()
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 161, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 253, in _run_trial
    raise func_err
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 311, in objective
    model.fit(X_train, y_train,
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/sklearn.py", line 1663, in fit
    train_dmatrix, evals = _wrap_evaluation_matrices(
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/sklearn.py", line 628, in _wrap_evaluation_matrices
    train_dmatrix = create_dmatrix(
                    ^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/sklearn.py", line 1137, in _create_dmatrix
    return QuantileDMatrix(
           ^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 1614, in __init__
    self._init(
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 1678, in _init
    it.reraise()
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 572, in reraise
    raise exc  # pylint: disable=raising-bad-type
    ^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 553, in _handle_exception
    return fn()
           ^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 640, in <lambda>
    return self._handle_exception(lambda: int(self.next(input_data)), 0)
                                              ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 1654, in next
    input_data(**self.kwargs)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 620, in input_data
    new, cat_codes, feature_names, feature_types = _proxy_transform(
                                                   ^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 1707, in _proxy_transform
    df, feature_names, feature_types = _transform_pandas_df(
                                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 640, in _transform_pandas_df
    feature_names, feature_types = pandas_feature_info(
                                   ^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 409, in pandas_feature_info
    _invalid_dataframe_dtype(data)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/data.py", line 372, in _invalid_dataframe_dtype
    raise ValueError(msg)
ValueError: DataFrame.dtypes for data must be int, float, bool or category. When categorical type is supplied, the experimental DMatrix parameter`enable_categorical` must be set to `True`.  Invalid columns:regime: object
