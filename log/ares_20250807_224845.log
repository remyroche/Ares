2025-08-07 22:48:45,547 - AresTradingSystem - INFO - âœ… Enhanced Logger initialization completed successfully
2025-08-07 22:48:45,554 - AresTradingSystem.System - INFO - Environment configuration loaded successfully. Trading Environment: PAPER, Exchange: BINANCE
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Initializing Signal Handler...
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Signal configuration loaded successfully
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Configuration validation successful
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Registered SIGTERM handler
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Registered SIGINT handler
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - Signal handlers registered successfully
2025-08-07 22:48:45,806 - AresTradingSystem.System.SignalHandler - INFO - âœ… Signal Handler initialization completed successfully
2025-08-07 22:48:45,808 - AresTradingSystem.System.SignalHandler - INFO - Shutdown callback registered
2025-08-07 22:48:46,820 - AresTradingSystem.System - INFO - Initializing Market Regime Classification Step...
2025-08-07 22:48:46,820 - AresTradingSystem.System - INFO - Market Regime Classification Step initialized successfully
2025-08-07 22:48:46,820 - AresTradingSystem.System - INFO - ðŸ”„ Executing Market Regime Classification...
2025-08-07 22:48:46,820 - AresTradingSystem.System - INFO - ðŸ“ Loading pre-consolidated data from: data_cache/aggtrades_BINANCE_ETHUSDT_consolidated.parquet
2025-08-07 22:48:47,211 - AresTradingSystem.System - INFO - âœ… Loaded consolidated trade data: 17744326 records
2025-08-07 22:48:47,211 - AresTradingSystem.System - INFO - ðŸ”„ Converting trade data to OHLCV format...
2025-08-07 22:48:49,122 - AresTradingSystem.System - INFO - âœ… Converted to OHLCV: 879 records
2025-08-07 22:48:49,122 - AresTradingSystem.System - INFO - Classifying market regimes for ETHUSDT on BINANCE...
2025-08-07 22:48:51,081 - AresTradingSystem.System - INFO - Regime classification completed. Found 1 distinct regimes
2025-08-07 22:48:51,082 - AresTradingSystem.System - INFO - âœ… Market regime classification completed. Results saved to data/training/BINANCE_ETHUSDT_regime_classification.json
2025-08-07 22:48:51,096 - AresTradingSystem.System - INFO - Initializing Regime Data Splitting Step...
2025-08-07 22:48:51,096 - AresTradingSystem.System - INFO - Regime Data Splitting Step initialized successfully
2025-08-07 22:48:51,097 - AresTradingSystem.System - INFO - ðŸ”„ Executing Regime Data Splitting...
2025-08-07 22:48:51,097 - AresTradingSystem.System - INFO - Loading prepared data from: data/training/ETHUSDT_prepared_data.pkl
2025-08-07 22:48:51,102 - AresTradingSystem.System - INFO - âœ… Loaded prepared data: (40190, 17)
2025-08-07 22:48:51,102 - AresTradingSystem.System - INFO - Splitting data by regimes for ETHUSDT on BINANCE...
2025-08-07 22:48:51,102 - AresTradingSystem.System - WARNING - Regime sequence length (854) is shorter than data length (40190). Repeating regime sequence to cover all data points.
2025-08-07 22:48:52,349 - AresTradingSystem.System - INFO - Regime 'SIDEWAYS': 40190 records
2025-08-07 22:48:52,349 - AresTradingSystem.System - INFO - High-data regimes: ['SIDEWAYS']
2025-08-07 22:48:52,349 - AresTradingSystem.System - INFO - Low-data regimes: []
2025-08-07 22:48:52,349 - AresTradingSystem.System - INFO - Other regimes: []
2025-08-07 22:48:52,349 - AresTradingSystem.System - INFO - Creating regime data for BULL (has models but no classification)
2025-08-07 22:48:52,350 - AresTradingSystem.System - INFO - Creating regime data for combined (has models but no classification)
2025-08-07 22:48:52,355 - AresTradingSystem.System - INFO - âœ… Regime data splitting completed. Results saved to data/training/regime_data
2025-08-07 22:48:52,513 - AresTradingSystem.System - INFO - Initializing Analyst Specialist Training Step...
2025-08-07 22:48:52,513 - AresTradingSystem.System - INFO - Analyst Specialist Training Step initialized successfully
2025-08-07 22:48:52,513 - AresTradingSystem.System - INFO - ðŸ”„ Executing Analyst Specialist Training...
2025-08-07 22:48:52,515 - AresTradingSystem.System - INFO - âœ… Loaded combined feature data: (951, 11)
2025-08-07 22:48:52,515 - AresTradingSystem.System - INFO - Training specialist models for regime: combined
2025-08-07 22:48:52,515 - AresTradingSystem.System - INFO - Training specialist models for regime: combined
2025-08-07 22:48:52,515 - AresTradingSystem.System - INFO - Dropping datetime columns: ['timestamp']
2025-08-07 22:48:52,516 - AresTradingSystem.System - INFO - Using 9 feature columns: ['open', 'high', 'low', 'close', 'volume']...
2025-08-07 22:48:52,651 - AresTradingSystem.System - INFO - âœ… Random Forest trained successfully for combined
2025-08-07 22:48:52,853 - AresTradingSystem.System - INFO - âœ… LightGBM trained successfully for combined
2025-08-07 22:48:53,005 - AresTradingSystem.System - INFO - âœ… XGBoost trained successfully for combined
2025-08-07 22:48:53,083 - AresTradingSystem.System - INFO - âœ… Neural Network trained successfully for combined
2025-08-07 22:48:53,173 - AresTradingSystem.System - INFO - âœ… SVM trained successfully for combined
2025-08-07 22:48:53,173 - AresTradingSystem.System - INFO - Trained 5 models for regime combined
2025-08-07 22:48:53,176 - AresTradingSystem.System - INFO - âœ… Saved main analyst model to data/training/BINANCE_ETHUSDT_analyst_model.pkl
2025-08-07 22:48:53,176 - AresTradingSystem.System - INFO - âœ… Saved model metadata to data/training/BINANCE_ETHUSDT_analyst_model_metadata.json
2025-08-07 22:48:53,176 - AresTradingSystem.System - INFO - âœ… Saved training history to data/training/BINANCE_ETHUSDT_analyst_training_history.json
2025-08-07 22:48:53,183 - AresTradingSystem.System - INFO - âœ… Analyst specialist training completed. Results saved to data/training/analyst_models
2025-08-07 22:48:56,519 - AresTradingSystem.System - INFO - Using device: MPS for PyTorch operations.
2025-08-07 22:48:56,519 - AresTradingSystem.System - INFO - Initializing Analyst Enhancement Step...
2025-08-07 22:48:56,519 - AresTradingSystem.System - INFO - Analyst Enhancement Step initialized successfully.
2025-08-07 22:48:56,519 - AresTradingSystem.System - INFO - ðŸ”„ Executing Analyst Enhancement...
2025-08-07 22:48:56,534 - AresTradingSystem.System - INFO - --- Enhancing models for regime: BULL ---
2025-08-07 22:48:56,534 - AresTradingSystem.System - INFO - Loading data for regime 'BULL'...
2025-08-07 22:48:56,535 - AresTradingSystem.System - INFO - Data loaded and split: X_train shape (800, 16), X_val shape (200, 16)
2025-08-07 22:48:56,535 - AresTradingSystem.System - INFO - Enhancing xgboost for BULL...
2025-08-07 22:48:56,535 - AresTradingSystem.System - INFO - Original model accuracy: 0.8399370026525199
2025-08-07 22:48:56,535 - AresTradingSystem.System - INFO - Running Optuna HPO with pruning for xgboost...
2025-08-07 22:48:56,573 - AresTradingSystem.System - ERROR - âŒ Error in Analyst Enhancement after 0.05s: [22:48:56] /Users/runner/work/xgboost/xgboost/src/objective/./regression_loss.h:69: Check failed: base_score > 0.0f && base_score < 1.0f: base_score must be in (0,1) for logistic loss, got: 0
Stack trace:
  [bt] (0) 1   libxgboost.dylib                    0x000000015ee8d9e0 dmlc::LogMessageFatal::~LogMessageFatal() + 124
  [bt] (1) 2   libxgboost.dylib                    0x000000015f13d580 xgboost::obj::LogisticRegression::ProbToMargin(float) + 176
  [bt] (2) 3   libxgboost.dylib                    0x000000015f09e11c xgboost::LearnerConfiguration::ConfigureModelParamWithoutBaseScore() + 212
  [bt] (3) 4   libxgboost.dylib                    0x000000015f0a3bb8 xgboost::LearnerConfiguration::InitBaseScore(xgboost::DMatrix const*) + 516
  [bt] (4) 5   libxgboost.dylib                    0x000000015f090074 xgboost::LearnerImpl::UpdateOneIter(int, std::__1::shared_ptr<xgboost::DMatrix>) + 140
  [bt] (5) 6   libxgboost.dylib                    0x000000015eeb056c XGBoosterUpdateOneIter + 144
  [bt] (6) 7   libffi.8.dylib                      0x0000000105eb8050 ffi_call_SYSV + 80
  [bt] (7) 8   libffi.8.dylib                      0x0000000105eb5868 ffi_call_int + 1452
  [bt] (8) 9   _ctypes.cpython-312-darwin.so       0x0000000105e988e0 _ctypes_callproc + 1168

Traceback (most recent call last):
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 105, in execute
    enhanced_model_package = await self._enhance_single_model(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 225, in _enhance_single_model
    best_params, hpo_score = await self._apply_hyperparameter_optimization(
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 372, in _apply_hyperparameter_optimization
    await asyncio.to_thread(study.optimize, objective, n_trials=100, n_jobs=-1)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/asyncio/threads.py", line 25, in to_thread
    return await loop.run_in_executor(None, func_call)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/study.py", line 489, in optimize
    _optimize(
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 101, in _optimize
    f.result()
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/concurrent/futures/thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 161, in _optimize_sequential
    frozen_trial = _run_trial(study, func, catch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 253, in _run_trial
    raise func_err
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/Users/remyroche/Documents/Ares/src/training/steps/step6_analyst_enhancement.py", line 357, in objective
    model.fit(X_train, y_train,
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/sklearn.py", line 1682, in fit
    self._Booster = train(
                    ^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 729, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/training.py", line 183, in train
    bst.update(dtrain, iteration=i, fobj=obj)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 2246, in update
    _check_call(
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/xgboost/core.py", line 310, in _check_call
    raise XGBoostError(py_str(_LIB.XGBGetLastError()))
xgboost.core.XGBoostError: [22:48:56] /Users/runner/work/xgboost/xgboost/src/objective/./regression_loss.h:69: Check failed: base_score > 0.0f && base_score < 1.0f: base_score must be in (0,1) for logistic loss, got: 0
Stack trace:
  [bt] (0) 1   libxgboost.dylib                    0x000000015ee8d9e0 dmlc::LogMessageFatal::~LogMessageFatal() + 124
  [bt] (1) 2   libxgboost.dylib                    0x000000015f13d580 xgboost::obj::LogisticRegression::ProbToMargin(float) + 176
  [bt] (2) 3   libxgboost.dylib                    0x000000015f09e11c xgboost::LearnerConfiguration::ConfigureModelParamWithoutBaseScore() + 212
  [bt] (3) 4   libxgboost.dylib                    0x000000015f0a3bb8 xgboost::LearnerConfiguration::InitBaseScore(xgboost::DMatrix const*) + 516
  [bt] (4) 5   libxgboost.dylib                    0x000000015f090074 xgboost::LearnerImpl::UpdateOneIter(int, std::__1::shared_ptr<xgboost::DMatrix>) + 140
  [bt] (5) 6   libxgboost.dylib                    0x000000015eeb056c XGBoosterUpdateOneIter + 144
  [bt] (6) 7   libffi.8.dylib                      0x0000000105eb8050 ffi_call_SYSV + 80
  [bt] (7) 8   libffi.8.dylib                      0x0000000105eb5868 ffi_call_int + 1452
  [bt] (8) 9   _ctypes.cpython-312-darwin.so       0x0000000105e988e0 _ctypes_callproc + 1168


